const e="undefined"!=typeof chrome&&chrome||"undefined"!=typeof browser&&browser||void 0;if(e){const i=(i,n)=>e.tabs.sendMessage(i,n),n=(e,n)=>i(e,{type:"command",value:n}),t=()=>e.tabs.query({active:!0,lastFocusedWindow:!0});e.action.disable(),e.runtime.onConnect.addListener((i=>{e.action.enable(i.sender.tab.id),i.sender.tab.id})),e.runtime.onMessage.addListener((i=>{const{type:n,value:t}=i;if("url"===n)e.tabs.create({url:t,active:!0})})),e.runtime.onInstalled.addListener((i=>{if(i.reason===e.runtime.OnInstalledReason.INSTALL)e.storage.local.set({installed:Date.now()}),e.runtime.openOptionsPage();else if(i.reason===e.runtime.OnInstalledReason.UPDATE){if(i.previousVersion<"3.0")e.storage.local.remove(["hideOnHome","hideOnTrending","hideOnSubscriptions","hideOnLibrary","hideOnHistory","hideOnChannel","hideOnPlaylist","hideOnWatch","hideOnResults","transparentBackgroundColor","showOnHover"]);else if(i.previousVersion<"3.4")e.storage.local.remove("blockAds"),e.storage.local.get("actionBarLeft").then((i=>{i.actionBarLeft&&(e.storage.local.set({positioning:"left"}),e.storage.local.remove("actionBarLeft"))}));else if(i.previousVersion<"3.6"){const i="blacklisted";e.storage.local.remove("counts"),e.storage.local.get(i).then((n=>{n[i]&&(e.storage.local.remove(i),e.storage.local.set({average:Date.now()}))}))}e.runtime.openOptionsPage()}})),e.commands.onCommand.addListener(((e,i)=>{i?i.id>=0&&n(i.id,e).catch((e=>{})):t().then((i=>i[0]&&n(i[0].id,e).catch((e=>{}))))}))}